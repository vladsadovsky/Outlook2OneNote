# Environment Configuration Template for Outlook2OneNote Add-in
# Copy this file to .env and replace placeholder values with your actual configuration
# 
# Setup Instructions:
# 1. Copy this file: cp .env-template .env
# 2. Replace placeholder values with your actual Azure AD app configuration
# 3. Never commit the .env file to git (it's already in .gitignore)

# =============================================================================
# Azure AD Application Configuration
# =============================================================================
# Get these values from Azure Portal > Azure Active Directory > App registrations

# Your Azure AD application (client) ID
CLIENT_ID=your-azure-app-client-id-here

# Your Azure AD application client secret (NEVER commit this to git!)
# Generate this in Azure Portal > App registrations > Your app > Certificates & secrets
CLIENT_SECRET=your-azure-app-client-secret-here

# Azure AD tenant ID or 'common' for multi-tenant apps
TENANT_ID=common

# =============================================================================
# Azure AD Endpoints
# =============================================================================
# These can usually stay as-is unless you're using a specific Azure cloud

AUTHORITY=https://login.microsoftonline.com/common
TOKEN_ENDPOINT=https://login.microsoftonline.com/common/oauth2/v2.0/token
AUTH_ENDPOINT=https://login.microsoftonline.com/common/oauth2/v2.0/authorize

# =============================================================================
# Application URLs
# =============================================================================
# Adjust these URLs based on your hosting environment

# Where Azure AD should redirect after user authentication
# Must be registered in Azure AD app > Authentication > Redirect URIs
REDIRECT_URI=https://localhost:3000/auth/callback

# Where to redirect after logout
POST_LOGOUT_REDIRECT_URI=https://localhost:3000

# =============================================================================
# Backend Service Configuration (Optional)
# =============================================================================
# If you deploy the backend service for enhanced security with client secrets

# URL of your deployed backend service (Azure Functions, App Service, etc.)
BACKEND_SERVICE_URL=https://your-backend-service.azurewebsites.net

# =============================================================================
# Development Settings
# =============================================================================

# Environment: development, staging, production
NODE_ENV=development

# Enable detailed authentication logging (true/false)
DEBUG_AUTH=true

# =============================================================================
# Microsoft Graph API Configuration
# =============================================================================

# Space-separated list of Microsoft Graph API scopes your app needs
# Notes.Read: Read OneNote notebooks
# User.Read: Read basic user profile information
GRAPH_SCOPES=https://graph.microsoft.com/Notes.Read https://graph.microsoft.com/User.Read

# =============================================================================
# Storage Configuration
# =============================================================================

# Use sessionStorage (true) or localStorage (false) for token storage
# sessionStorage is more secure but tokens don't persist across browser sessions
USE_SESSION_STORAGE=true

# Enable client-side token encryption (experimental, not implemented yet)
STORAGE_ENCRYPTION=false

# =============================================================================
# Example Values for Different Environments
# =============================================================================

# Development (localhost):
# REDIRECT_URI=https://localhost:3000/auth/callback
# POST_LOGOUT_REDIRECT_URI=https://localhost:3000
# BACKEND_SERVICE_URL=http://localhost:3001

# Staging:
# REDIRECT_URI=https://your-app-staging.azurewebsites.net/auth/callback
# POST_LOGOUT_REDIRECT_URI=https://your-app-staging.azurewebsites.net
# BACKEND_SERVICE_URL=https://your-backend-staging.azurewebsites.net

# Production:
# REDIRECT_URI=https://your-production-domain.com/auth/callback
# POST_LOGOUT_REDIRECT_URI=https://your-production-domain.com
# BACKEND_SERVICE_URL=https://your-backend-production.azurewebsites.net

# =============================================================================
# Azure AD App Registration Checklist
# =============================================================================
# 
# Before using this configuration, make sure you've completed these steps:
# 
# 1. ✅ Created Azure AD app registration
# 2. ✅ Copied Client ID to CLIENT_ID above
# 3. ✅ Generated client secret and copied to CLIENT_SECRET above
# 4. ✅ Added redirect URIs in Azure AD app > Authentication
# 5. ✅ Added Microsoft Graph API permissions (Notes.Read, User.Read)
# 6. ✅ Granted admin consent for the permissions
# 7. ✅ Configured supported account types (single/multi-tenant)
# 
# For detailed setup instructions, see: ENVIRONMENT-SETUP.md
